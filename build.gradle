/*
 * This file was generated by the Gradle 'init' task.
 *
 * This is a general purpose Gradle build.
 * Learn more about Gradle by exploring our samples at https://docs.gradle.org/6.7.1/samples
 */
plugins {
    id 'java'
    id 'org.jetbrains.intellij' version '1.2.1'
    id 'org.jetbrains.changelog' version '1.3.0'
}

def findProperty(key){
    return project.findProperty(key).toString();
}

group = findProperty('pluginGroup')
version = findProperty('pluginVersion');

sourceCompatibility = findProperty('javaVersion')
targetCompatibility = findProperty('javaVersion')

apply {
    plugin 'org.jetbrains.intellij'
    plugin "org.jetbrains.changelog"
}


repositories {
    mavenLocal()
    mavenCentral()
}

dependencies {

}



// See https://github.com/JetBrains/gradle-intellij-plugin/
intellij {
    pluginName = findProperty('pluginName')
    plugins = findProperty("platformPlugins").split(',').collect{ it.trim() }.findAll{ it!=''}
    version = findProperty('platformVersion')
    type = findProperty('platformType')
    //sameSinceUntilBuild = true
    platformDownloadSources = findProperty('platformDownloadSources')
}


tasks{
    wrapper{
        gradleVersion(findProperty("gradleVersion"))
    }
    patchPluginXml{
        pluginName = findProperty('pluginName')
        changeNotes = changelog.getUnreleased().toHTML()
        pluginSinceBuild = findProperty('pluginSinceBuild')
        pluginUntilBuild = findProperty('pluginUntilBuild')
    }
    publishPlugin {
        token = System.getenv("ORG_GRADLE_PROJECT_intellijPublishToken")
    }
}
